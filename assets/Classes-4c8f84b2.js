import{r as x,j as t,F,Y as O}from"./index-2da7a7c0.js";import{C as L,c as j,h as N}from"./View-7d01b1b2.js";function Z({input:c,classes:m,setLoading:f}){x.useEffect(()=>{f(!0)},[]);let n=c.split(",");n=n.map(e=>e.trim());const{chosenClasses:a,setChosenClasses:h,setHoveredClass:p}=x.useContext(L);function b(e,s){const u=["[0-9]","[0-9]","[0-9]","-","[0-9A-Z]","[0-9A-Z]","[0-9A-Z]","-","[0-9A-Z]","[0-9A-Z]"].slice(0,e.length).join(""),C=new RegExp(u);if(e==="@")return s.filter(r=>a.some(o=>r.code===o.code&&r.section===o.section)||a.some(o=>r.code===o.code)?!1:!j(N([...a,r],!0)));if(["r>","r<","r="].includes(e.slice(0,2))&&e.length>2){if(!Number(e.slice(2)))return[];const r=Number(e.slice(2));switch(e[1]){case"=":return s.filter(l=>l.lecture.rating.avg===r);case">":return s.filter(l=>l.lecture.rating.avg>=r);case"<":return s.filter(l=>l.lecture.rating.avg<=r)}}else if(["s>","s<","s="].includes(e.slice(0,2))&&e.length>2){if(!Number(e.slice(2)))return[];const r=Number(e.slice(2));switch(e[1]){case"=":return s.filter(l=>l.lecture.rating.score===r);case">":return s.filter(l=>l.lecture.rating.score>=r);case"<":return s.filter(l=>l.lecture.rating.score<=r)}}else if(e.slice(0,2)==="p="){const r=e.slice(2).toLowerCase();return s.filter(l=>l.lecture.prof.toLowerCase().includes(r))}else{if(C.test(e))return s.filter(r=>r.code.includes(e));if(e.split("").every(r=>"MTWRF".includes(r)))return s.filter(r=>{const l=structuredClone(Object.keys(r.lecture)),o=structuredClone(Object.keys(r.lab));return l.filter(g=>!["title","prof","rating"].includes(g)).concat(o.filter(g=>!["title","prof","rating"].includes(g))).join("").includes(e)});if(e.toUpperCase()===e)return s.filter(r=>r.course.includes(e));if(["honours","blended"].some(r=>r===e.toLowerCase())){const r=e.toLowerCase();if("honours".startsWith(r))return s.filter(l=>l.more.startsWith("For Honours"));if("blended".startsWith(r))return s.filter(l=>l.more.startsWith("BLENDED"))}else return s.filter(r=>r.lecture.title.toLowerCase().includes(e.toLowerCase()))}return[]}let d=b(n[0],m);n.slice(1).forEach(e=>{d=b(e,d)});function A(e){if(a.some(s=>e.code===s.code&&e.section===s.section))h(a.filter(s=>!(e.code===s.code&&e.section===s.section)));else if(a.some(s=>e.code===s.code)){alert("You already have a class from this course");return}else{if(j(N([...a,e],!0))){alert("The chosen class overlaps with another!");return}h([...a,e])}}return t.jsx(t.Fragment,{children:d.map((e,s)=>t.jsxs("div",{className:"bg-c2 p-2 box-border md:mb-3 mb-2 rounded-lg md:shadow-lg shadow-md hover:bg-c3 transition cursor-pointer md:text-base text-xs",onClick:()=>A(e),onPointerOver:()=>p(e),onPointerOut:()=>p(void 0),children:[t.jsxs("p",{className:"font-light",children:[e.program,": ",e.course," ",e.code]}),t.jsxs("p",{className:"md:text-xl font-bold text-base",children:[e.section," ",e.lecture.title]}),t.jsxs("div",{className:"ml-4 relative",children:[e.lecture.prof," ",t.jsx("span",{className:"font-bold",children:e.lecture.rating.score===0||!e.lecture.rating.score?"N/A":e.lecture.rating.score})," ",t.jsx(v,{rating:e.lecture.rating})]}),Object.entries(e.lecture).filter(i=>!["title","prof","rating"].includes(i[0])).map((i,u)=>t.jsxs("p",{className:"ml-8 font-extralight",children:[t.jsx("span",{className:"font-normal",children:i[0]})," ",i[1]]},u)),"prof"in e.lab&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"ml-4 relative",children:[t.jsx("u",{children:"Lab"}),": ",e.lab.prof," ",t.jsx("span",{className:"font-bold",children:e.lab.rating.score===0||!e.lab.rating.score?"N/A":e.lab.rating.score})," ",t.jsx(v,{rating:e.lab.rating})]}),Object.entries(e.lab).filter(i=>!["title","prof","rating"].includes(i[0])).map((i,u)=>t.jsxs("p",{className:"ml-8 font-extralight",children:[t.jsx("span",{className:"font-normal",children:i[0]})," ",i[1]]},u))]}),e.more!==""&&t.jsx(t.Fragment,{children:t.jsx("p",{className:"text-c6",children:e.more})})]},`i.code + ${s}`))})}function v({rating:c}){const[m,f]=x.useState(!1),n=c.avg;return t.jsxs(t.Fragment,{children:[t.jsx(F,{icon:O,className:"cursor-pointer",onPointerOver:()=>f(!0),onPointerOut:()=>f(!1)}),m&&t.jsxs("div",{className:"absolute top-0 left-0 mt-6 bg-[white] rounded-lg p-2 z-10 text-xs flex",children:[t.jsx("p",{className:"w-full",children:"The score is calculated to take into account the number of raters. A high rating with low raters will perform worse in comparison to a lower rating with many raters."}),t.jsxs("ul",{className:"pl-4 shrink-0",children:[t.jsxs("li",{className:"list-disc",children:["Rating: ",n===0||!n?"N/A":`${c.avg}/5`]}),t.jsxs("li",{className:"list-disc",children:["Raters: ",n===0||!n?"N/A":c.nRating]}),t.jsxs("li",{className:"list-disc",children:["Take Again:"," ",n===0||!n?"N/A":`${c.takeAgain.toFixed(1)}%`]}),t.jsxs("li",{className:"list-disc",children:["Difficulty: ",n===0||!n?"N/A":`${c.difficulty}/5`]})]})]})]})}export{Z as default};
