import{r as x,j as t,F as A,Y as C}from"./index-5eb48ded.js";import{C as F,c as O,h as L}from"./View-1399a7a3.js";function Z({input:c,classes:m,setLoading:f}){x.useEffect(()=>{f(!0)},[]);let n=c.split(",");n=n.map(e=>e.trim());const{chosenClasses:a,setChosenClasses:h,setHoveredClass:p}=x.useContext(F);function b(e,r){const u=["[0-9]","[0-9]","[0-9]","-","[0-9A-Z]","[0-9A-Z]","[0-9A-Z]","-","[0-9A-Z]","[0-9A-Z]"].slice(0,e.length).join(""),v=new RegExp(u);if(e==="@")return r.filter(s=>a.some(o=>s.code===o.code&&s.section===o.section)||a.some(o=>s.code===o.code)?!1:!O(L([...a,s],!0)));if(["r>","r<","r="].includes(e.slice(0,2))&&e.length>2){if(!Number(e.slice(2)))return[];const s=Number(e.slice(2));switch(e[1]){case"=":return r.filter(l=>l.lecture.rating.avg===s);case">":return r.filter(l=>l.lecture.rating.avg>=s);case"<":return r.filter(l=>l.lecture.rating.avg<=s)}}else if(["s>","s<","s="].includes(e.slice(0,2))&&e.length>2){if(!Number(e.slice(2)))return[];const s=Number(e.slice(2));switch(e[1]){case"=":return r.filter(l=>l.lecture.rating.score===s);case">":return r.filter(l=>l.lecture.rating.score>=s);case"<":return r.filter(l=>l.lecture.rating.score<=s)}}else if(e.slice(0,2)==="p="){const s=e.slice(2).toLowerCase();return r.filter(l=>l.lecture.prof.toLowerCase().includes(s))}else{if(v.test(e))return r.filter(s=>s.code.includes(e));if(e.split("").every(s=>"MTWRF".includes(s)))return r.filter(s=>{const l=structuredClone(Object.keys(s.lecture)),o=structuredClone(Object.keys(s.lab));return l.filter(g=>!["title","prof","rating"].includes(g)).concat(o.filter(g=>!["title","prof","rating"].includes(g))).join("").includes(e)});if(e.toUpperCase()===e)return r.filter(s=>s.course.includes(e));if(["honours","blended"].some(s=>s===e.toLowerCase())){const s=e.toLowerCase();if("honours".startsWith(s))return r.filter(l=>l.more.startsWith("For Honours"));if("blended".startsWith(s))return r.filter(l=>l.more.startsWith("BLENDED"))}else return r.filter(s=>s.lecture.title.toLowerCase().includes(e.toLowerCase()))}return[]}let d=b(n[0],m);n.slice(1).forEach(e=>{d=b(e,d)});function N(e){if(a.some(r=>e.code===r.code&&e.section===r.section))h(a.filter(r=>!(e.code===r.code&&e.section===r.section)));else if(a.some(r=>e.code===r.code)){alert("You already have a class from this course");return}else h([...a,e])}return t.jsx(t.Fragment,{children:d.map((e,r)=>t.jsxs("div",{className:"bg-c2 p-2 box-border md:mb-3 mb-2 rounded-lg md:shadow-lg shadow-md hover:bg-c3 transition cursor-pointer md:text-base text-xs",onClick:()=>N(e),onPointerOver:()=>p(e),onPointerOut:()=>p(void 0),children:[t.jsxs("p",{className:"font-light",children:[e.program,": ",e.course," ",e.code]}),t.jsxs("p",{className:"md:text-xl font-bold text-base",children:[e.section," ",e.lecture.title]}),t.jsxs("div",{className:"ml-4 relative",children:[e.lecture.prof," ",t.jsx("span",{className:"font-bold",children:e.lecture.rating.score===0||!e.lecture.rating.score?"N/A":e.lecture.rating.score})," ",t.jsx(j,{rating:e.lecture.rating})]}),Object.entries(e.lecture).filter(i=>!["title","prof","rating"].includes(i[0])).map((i,u)=>t.jsxs("p",{className:"ml-8 font-extralight",children:[t.jsx("span",{className:"font-normal",children:i[0]})," ",i[1]]},u)),"prof"in e.lab&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"ml-4 relative",children:[t.jsx("u",{children:"Lab"}),": ",e.lab.prof," ",t.jsx("span",{className:"font-bold",children:e.lab.rating.score===0||!e.lab.rating.score?"N/A":e.lab.rating.score})," ",t.jsx(j,{rating:e.lab.rating})]}),Object.entries(e.lab).filter(i=>!["title","prof","rating"].includes(i[0])).map((i,u)=>t.jsxs("p",{className:"ml-8 font-extralight",children:[t.jsx("span",{className:"font-normal",children:i[0]})," ",i[1]]},u))]}),e.more!==""&&t.jsx(t.Fragment,{children:t.jsx("p",{className:"text-c6",children:e.more})})]},`i.code + ${r}`))})}function j({rating:c}){const[m,f]=x.useState(!1),n=c.avg;return t.jsxs(t.Fragment,{children:[t.jsx(A,{icon:C,className:"cursor-pointer",onPointerOver:()=>f(!0),onPointerOut:()=>f(!1)}),m&&t.jsxs("div",{className:"absolute top-0 left-0 mt-6 bg-[white] rounded-lg p-2 z-10 text-xs flex",children:[t.jsx("p",{className:"w-full",children:"The score is calculated to take into account the number of raters. A high rating with low raters will perform worse in comparison to a lower rating with many raters."}),t.jsxs("ul",{className:"pl-4 shrink-0",children:[t.jsxs("li",{className:"list-disc",children:["Rating: ",n===0||!n?"N/A":`${c.avg}/5`]}),t.jsxs("li",{className:"list-disc",children:["Raters: ",n===0||!n?"N/A":c.nRating]}),t.jsxs("li",{className:"list-disc",children:["Take Again:"," ",n===0||!n?"N/A":`${c.takeAgain.toFixed(1)}%`]}),t.jsxs("li",{className:"list-disc",children:["Difficulty: ",n===0||!n?"N/A":`${c.difficulty}/5`]})]})]})]})}export{Z as default};
