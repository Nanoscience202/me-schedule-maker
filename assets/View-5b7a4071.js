import{r as i,j as e,F as w,R as _,T as F,u as O,a as y,V as $,W as I,X as T,Y as A,Z as X,O as D,U,Q as V,a0 as W,$ as z,a1 as L}from"./index-dec0ba19.js";const B=i.lazy(()=>F(()=>import("./Classes-2dfc7cd9.js"),["assets/Classes-2dfc7cd9.js","assets/index-dec0ba19.js","assets/index-b7937a8c.css"]));function H({classes:c,setLoading:l,viewData:n,userData:o}){const[a,d]=i.useState(""),r=i.useDeferredValue(a),[s,t]=i.useState("search"),u=i.useDeferredValue(s),[x,h]=i.useState(!1);return e.jsxs("section",{className:"md:col-span-5 md:row-span-6 bg-c1 rounded-lg box-border flex flex-col max-md:order-2",children:[e.jsxs("nav",{className:"flex justify-between w-full p-2 box-border",children:[e.jsx(S,{current:s,setCurrent:t,text:"search"}),e.jsx(S,{current:s,setCurrent:t,text:"filter"}),e.jsx(S,{current:s,setCurrent:t,text:"saved"})]}),s==="search"&&u===s?e.jsxs(e.Fragment,{children:[e.jsxs("label",{className:"relative md:mx-4 mx-2 mt-2",children:[e.jsx(w,{icon:_,className:"absolute top-1/2 right-2 -translate-y-1/2 cursor-pointer",onMouseOver:()=>h(!0),onMouseOut:()=>h(!1)}),x&&e.jsxs("div",{className:"absolute z-20 top-0 right-0 md:translate-x-full -translate-x-10 bg-[white] p-2 rounded-lg md:max-w-sm w-[70dvw]",children:[e.jsx("p",{children:"Search by keywords, separate them by a comma. Use the filter tab to make your life easier."}),e.jsxs("div",{children:[e.jsx("span",{className:"font-bold",children:"Available options:"}),e.jsxs("ul",{className:"pl-4 [&>li]:list-disc [&>li>span]:font-bold",children:[e.jsxs("li",{children:[e.jsx("span",{children:"@"}),": only show available classes."]}),e.jsxs("li",{children:[e.jsxs("span",{children:["r",">","n"]}),": Teachers with +n/5 rating on ratemyprofessor. Symbol can be ","<",", ",">"," or = (e.g. r","=","5)"]}),e.jsxs("li",{children:[e.jsxs("span",{children:["s",">","n"]}),": Teachers with +n/100 score. Symbol can be ","<",", ",">"," or =. (e.g. s=100)"]}),e.jsxs("li",{children:[e.jsx("span",{children:"honours/blended"}),": special keywords."]}),e.jsxs("li",{children:[e.jsx("span",{children:"p=professor"}),": classes taught by"," ",e.jsx("i",{children:"professor"})," (e.g. p=patrik searches classes taught by professors with patrik in their names)"]}),e.jsxs("li",{children:[e.jsx("span",{children:"COURSE_NAME"}),": searches classes that belongs in COURSE_NAME (e.g. ENGLISH searches for english classes)"]}),e.jsxs("li",{children:[e.jsx("span",{children:"XXX-XXX-XXX"}),": course code."]}),e.jsxs("li",{children:[e.jsx("span",{children:"M/T/W/R/F"}),": has class on that day."]}),e.jsxs("li",{children:[e.jsx("span",{children:"class_name"}),": if its none of the abovementioned keywords, it will treat the keyword as the class name."]})]})]})]}),e.jsx("input",{className:"bg-c2 w-full p-1 md:text-lg rounded-lg outline-none shrink-0 focus:bg-c4 transition md:shadow-lg shadow-md",placeholder:"COURSE, code, professor, rating, class name, ...",value:a,onChange:b=>d(b.target.value)})]}),e.jsx("div",{className:"w-full h-full box-border rounded-lg overflow-y-auto md:px-4 px-2 md:mt-4 mt-2",children:e.jsx(i.Suspense,{fallback:e.jsx(M,{}),children:r===a?e.jsx(B,{input:r,classes:c,setLoading:l}):e.jsx(M,{})})})]}):s==="search"&&e.jsx(M,{}),s==="filter"&&e.jsx(Z,{setInput:d,setCurrent:t}),s==="saved"&&e.jsx(Q,{viewData:n,userData:o})]})}function S({current:c,setCurrent:l,text:n}){var r;const o={width:c===n?"100%":"0%"},[a,d]=O(()=>({from:o}),[]);return i.useEffect(()=>{d.start({to:o})},[c]),e.jsxs("div",{className:"w-1/3 text-center cursor-pointer box-border border-c9 border-solid relative flex justify-center",onClick:()=>l(n),children:[(r=n.at(0))==null?void 0:r.toUpperCase().concat(n.slice(1)),e.jsx(y.p,{className:"absolute h-full box-border border-solid border-b-c9 border-b-2",style:a})]})}function P(c){const l=c.flat().map(s=>s.time),n=l.filter(s=>s[1]).flatMap(s=>Object.values(s)),o=l.filter(s=>s[2]).flatMap(s=>Object.values(s)),a=l.filter(s=>s[3]).flatMap(s=>Object.values(s)),d=l.filter(s=>s[4]).flatMap(s=>Object.values(s)),r=l.filter(s=>s[5]).flatMap(s=>Object.values(s));return!![n,o,a,d,r].some(s=>{if(s.length<=1)return!1;const t=s.at(-1);return!!s.slice(0,-1).some(u=>Number(u[0])>Number(t[0])?Number(t[1])>Number(u[0]):Number(u[0])<Number(t[0])?Number(t[0])<Number(u[1]):Number(u[0])===Number(t[0]))})}function J(c,l){const n=["M","T","W","R","F"],o=[...Array(21).keys()].map(r=>(r%2===0?r*50+800:Math.floor(r/2)*2*50+830).toFixed(0)),a=["hsl(150,97%,85%)","hsl(230,97%,85%)","hsl(110,97%,85%)","hsl(270,97%,85%)","hsl(70,97%,85%)","hsl(310,97%,85%)","hsl(30,97%,85%)","hsl(350,97%,85%)","hsl(190,97%,85%)"];return c.map((r,s)=>{const t=structuredClone(Object.entries(r.lecture)),u=structuredClone(Object.entries(r.lab?r.lab:{}));return t.filter(h=>!["title","prof","rating"].includes(h[0])).concat(u.filter(h=>!["title","prof","rating"].includes(h[0]))).flatMap(h=>{const b=h[0].split("").filter(p=>p==="S"&&!l?(alert("There is class on Saturday as well"),!1):!0),j=h[1],f=j.split("-")[0],g=j.split("-")[1];return b.flatMap(p=>{const N=o.findIndex(m=>Number(m)===Number(f))+1,k=o.findIndex(m=>Number(m)===Number(g))+1,C=n.findIndex(m=>m===p)+1;return{code:r.code,section:r.section,time:{[`${C}`]:[N,k]},color:a[s],teacher:r.lecture.prof,title:r.lecture.title}})})})}function M(){return e.jsxs("div",{className:"gap-2 w-full h-full flex flex-col items-center justify-center",children:[e.jsx("img",{src:"/me-schedule-maker/images/cooking-pot.gif",alt:"cooking-pot git",className:"h-20"}),e.jsx("p",{children:"Wait it's cooking"})]})}function Q({viewData:c,userData:l}){const n="jac-mock-schedule-maker",[o,a]=i.useState(()=>{if(l)return l.schedules?l.schedules:[];{const t=window.localStorage.getItem(n);return t?JSON.parse(t):[]}}),d=i.useRef(o.length),{chosenClasses:r}=i.useContext(v);function s(t){do d.current+=1;while(o.map(u=>u.id).includes(d.current));a([...o,{id:d.current,vData:t,data:r}])}return i.useEffect(()=>{l?$(l.uid,o).catch(t=>console.log(t)):window.localStorage.setItem(n,JSON.stringify(o))},[o]),e.jsxs("section",{className:"bg-c1 rounded-lg box-border flex w-full flex-wrap gap-2 p-2",children:[e.jsx("div",{className:"bg-c2 hover:bg-c3 active:bg-c4 transition rounded-md flex items-center justify-center md:p-4 p-2 cursor-pointer h-20",onClick:()=>s(c),children:e.jsx(w,{icon:I,className:"md:text-4xl text-xl"})}),o.map(t=>e.jsx(Y,{i:t,savedSchedule:o,setSavedSchedule:a},t.id))]})}function G({blocksToShow:c}){return c.map(l=>{const n=Object.entries(l.time).flat();return e.jsx("div",{className:"z-10 border border-[black] box-border rounded-sm",style:{gridColumnStart:n[0],gridRowStart:n[1][0],gridRowEnd:n[1][1],backgroundColor:l.color}},l.code+l.section+n[0])})}function Y({i:c,savedSchedule:l,setSavedSchedule:n}){const{setChosenClasses:o}=i.useContext(v),a=structuredClone(c);a.data||(a.data=[]),a.vData||(a.vData=[]);const[d,r]=O(()=>({from:{opacity:0,y:30,scale:1},to:{opacity:1,y:0}}),[]);function s(u){u.stopPropagation(),r.start({from:{opacity:1,scale:1},to:{opacity:0,scale:0},onResolve:()=>{n(l.filter(x=>x.id!==c.id))}})}function t(){o(a.data)}return e.jsxs(y.div,{className:"min-w-[calc(5rem*1.6)] bg-[white] rounded-md grid grid-rows-[repeat(20,minmax(0,1fr))] grid-cols-5 relative hover:bg-slate-200 md:shadow-lg shadow-md cursor-pointer h-20 overflow-hidden",style:d,onClick:t,children:[a.vData.map((u,x)=>e.jsx(G,{blocksToShow:u},x)),e.jsx(w,{icon:T,className:"absolute opacity-10 m-1 bottom-0 right-0 hover:opacity-50 cursor-pointer",onClick:s})]},c.id)}function Z({setInput:c,setCurrent:l}){const[n,o]=i.useState(!1),a=i.useRef(null);function d(r){if(r.preventDefault(),!a.current){c(""),l("search");return}const s=a.current;function t(m){return s.elements.namedItem(m)}const u=t("courseName").value.toUpperCase(),x=t("className").value,h=t("teacherName").value.split(" ").flatMap(m=>m.split(",")).filter(m=>m!=="").map(m=>`p=${m}`),b=Number(t("ratingMax").value),j=Number(t("ratingMin").value),f=[j?`r>${j}`:"",b?`r<${b}`:""],g=Number(t("scoreMax").value),p=Number(t("scoreMin").value),N=[p?`s>${p}`:"",g?`s<${g}`:""],k=["monday","tuesday","wednesday","thursday","friday","honours","blended","available"].map(m=>t(m).checked).map((m,R)=>m?["M","T","W","R","F","honours","blended","@"].at(R):""),C=[u,x,...h,...f,...N,...k];c(C.filter(m=>m!=="").join(", ")),l("search")}return e.jsx("div",{className:"box-border w-full h-full p-2 overflow-auto",children:e.jsxs("form",{onSubmit:d,className:"flex flex-col md:text-xl text-base gap-4",ref:a,children:[e.jsxs("label",{children:[e.jsx("p",{className:"font-semibold",children:"Course Name or Code"}),e.jsx("input",{placeholder:"English",className:"outline-none focus:bg-c2 w-full rounded-lg p-1",name:"courseName"})]}),e.jsxs("label",{children:[e.jsx("p",{className:"font-semibold",children:"Class Name"}),e.jsx("input",{placeholder:"Hockey is everything",className:"outline-none focus:bg-c2 w-full rounded-lg p-1",name:"className"})]}),e.jsxs("label",{children:[e.jsx("p",{className:"font-semibold",children:"Teacher Name"}),e.jsx("input",{placeholder:"Patrik Burger",className:"outline-none focus:bg-c2 w-full rounded-lg p-1",name:"teacherName"})]}),e.jsxs("div",{className:"flex gap-4 w-full",children:[e.jsxs("label",{className:"basis-1/2",children:[e.jsx("p",{className:"font-semibold",children:"Rating /5"}),e.jsxs("div",{className:"flex gap-1 w-full",children:[e.jsx("div",{className:"basis-full",children:e.jsx("input",{className:"outline-none focus:bg-c2 w-full rounded-lg p-1",placeholder:"0",name:"ratingMin"})}),e.jsx("p",{className:"flex items-center",children:"to"}),e.jsx("div",{className:"basis-full",children:e.jsx("input",{className:"outline-none focus:bg-c2 w-full rounded-lg p-1",placeholder:"5",name:"ratingMax"})})]})]}),e.jsxs("label",{className:"basis-1/2",children:[e.jsxs("div",{className:"font-semibold relative",children:["Score /100",e.jsx(w,{icon:A,className:"ml-2",onMouseOver:()=>o(!0),onMouseOut:()=>o(!1)}),n&&e.jsx("div",{className:"absolute top-0 left-0 mt-6 bg-[white] rounded-lg p-2 z-10 text-xs flex",children:e.jsx("p",{className:"w-full",children:"The score is calculated to take into account the number of raters. A high rating with low raters will perform worse in comparison to a lower rating with many raters."})})]}),e.jsxs("div",{className:"flex gap-1 w-full",children:[e.jsx("div",{className:"basis-full",children:e.jsx("input",{className:"outline-none focus:bg-c2 w-full rounded-lg p-1",placeholder:"0",name:"scoreMin"})}),e.jsx("p",{className:"flex items-center",children:"to"}),e.jsx("div",{className:"basis-full",children:e.jsx("input",{className:"outline-none focus:bg-c2 w-full rounded-lg p-1",placeholder:"100",name:"scoreMax"})})]})]})]}),e.jsxs("label",{className:"flex gap-4",children:[e.jsxs("div",{className:"basis-1/2",children:[e.jsx("p",{className:"font-semibold",children:"Days"}),e.jsxs("p",{className:"pl-4",children:[e.jsx("input",{type:"checkbox",name:"monday"})," Monday"]}),e.jsxs("p",{className:"pl-4",children:[e.jsx("input",{type:"checkbox",name:"tuesday"})," Tuesday"]}),e.jsxs("p",{className:"pl-4",children:[e.jsx("input",{type:"checkbox",name:"wednesday"})," Wednesday"]}),e.jsxs("p",{className:"pl-4",children:[e.jsx("input",{type:"checkbox",name:"thursday"})," Thursday"]}),e.jsxs("p",{className:"pl-4",children:[e.jsx("input",{type:"checkbox",name:"friday"})," Friday"]})]}),e.jsxs("div",{className:"basis-1/2",children:[e.jsx("p",{className:"font-semibold",children:"Special"}),e.jsxs("p",{className:"pl-4",children:[e.jsx("input",{type:"checkbox",name:"honours"})," Honours"]}),e.jsxs("p",{className:"pl-4",children:[e.jsx("input",{type:"checkbox",name:"blended"})," Blended"]})]})]}),e.jsxs("label",{children:[e.jsx("p",{className:"font-semibold",children:"Options"}),e.jsxs("p",{className:"pl-4",children:[e.jsx("input",{type:"checkbox",name:"available"})," Only show available classes"]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"reset",className:"rounded-lg p-2 transition hover:outline-c9 outline outline-1 outline-c1",children:"Clear"}),e.jsx("button",{type:"submit",className:"rounded-lg bg-c9 p-2 text-c1 transition hover:bg-c7",children:"Apply"})]})]})})}const v=i.createContext({chosenClasses:[],setChosenClasses:()=>{}});function q({login:c}){X.assign({frameLoop:"always"});const l=D(),[n,o]=i.useState([]),[a,d]=i.useState(!1),[r,s]=i.useState([]),[t,u]=i.useState(null),x=i.useMemo(()=>J(r),[r]),{user:h}=i.useContext(U);i.useEffect(()=>{P(x)&&(s(r.slice(0,-1)),alert("The chosen class overlaps with another!"))},[x]),i.useEffect(()=>{c&&(h?V(h.uid,f=>{u({uid:h.uid,schedules:f.val()})},"schedules"):l("/"));async function j(f,g){try{const p=await fetch(f);if(!p.ok)throw new Error("Network response was not ok");const N=await p.json();g(N)}catch(p){console.log(p)}}j("/me-schedule-maker/data/all.json",o).catch(f=>console.log(f))},[h,c]);async function b(){await z()}return e.jsxs(v.Provider,{value:{chosenClasses:r,setChosenClasses:s},children:[e.jsxs("nav",{className:"md:text-base text-xs w-full bg-c9 text-c1 shrink-0 flex justify-between items-center",children:[e.jsx(w,{icon:W,className:"ml-2 cursor-pointer transition hover:text-c4",onClick:()=>l("/")}),e.jsxs("p",{children:["Fall 2023 JAC"," ",e.jsx("span",{className:" max-md:hidden",children:"Mock Schedule Maker"})]}),e.jsx("p",{onClick:()=>void b(),className:"mr-2 cursor-pointer transition hover:text-c4",children:t?"Sign Out":""})]}),e.jsxs("section",{className:"w-full basis-full bg-c9 md:grid md:grid-cols-12 md:grid-rows-6 box-border gap-2 px-2 pb-2 text-c9 flex flex-col md:text-base text-xs overflow-auto",children:[e.jsx(H,{classes:n,setLoading:d,viewData:x,userData:t}),a&&n.length!==0&&e.jsx(e.Fragment,{children:e.jsx(K,{viewData:x})})]})]})}const ae=Object.freeze(Object.defineProperty({__proto__:null,ClassContext:v,default:q},Symbol.toStringTag,{value:"Module"}));function K({viewData:c,login:l}){const[n,o]=i.useState([]);return i.useEffect(()=>{o(()=>c.map((a,d)=>e.jsx(i.Fragment,{children:e.jsx(ee,{blocksToShow:a,login:l})},d)))},[c]),e.jsxs("section",{className:"rounded-lg md:col-span-7 md:row-span-6 max-md:min-h-[60%] col-span-full bg-c1 md:p-4 p-2 box-border grid grid-cols-[1fr_repeat(5,minmax(0,2fr))] grid-rows-[repeat(21,minmax(0,1fr))] max-md:order-1",children:[e.jsx("div",{className:"col-span-1 row-span-full grid grid-cols-1 grid-rows-[repeat(21,minmax(0,1fr))]",children:[...Array(21).keys()].map(a=>e.jsxs("span",{className:"translate-y-1/2 box-border md:pr-4 md:text-xs text-[0.5rem] flex items-center justify-end pr-2",children:[Math.floor(a/2)+8,":",a%2===0?"00":"30"]},a))}),e.jsxs("div",{className:"col-span-5 row-span-full grid grid-cols-5 grid-rows-[repeat(21,minmax(0,1fr))] border-collapse relative",children:[e.jsx("div",{className:"absolute w-full h-full grid grid-rows-[repeat(20,minmax(0,1fr))] row-start-2",children:[...Array(19).keys()].map(a=>e.jsx("div",{children:e.jsx(E,{n:a,lineProperty:"width"})},`horizontal-${a}`))}),e.jsxs("div",{className:"absolute w-full h-full grid grid-cols-5 grid-rows-[repeat(21,minmax(0,1fr))]",children:[e.jsx("div",{className:"row-span-1 col-span-full"}),[...Array(4).keys()].map(a=>e.jsx("div",{className:"row-[span_20/span_20]",children:e.jsx(E,{n:a,lineProperty:"height"})},`vertical-${a}`))]}),["Monday","Tuesday","Wednesday","Thursday","Friday"].map(a=>{const d=window.innerWidth>=1100?a:a.slice(0,3);return e.jsx("span",{className:"text-center font-semibold md:text-base text-xs",children:d},a)}),e.jsx("div",{className:"grid grid-rows-[repeat(20,minmax(0,1fr))] grid-cols-5 bg-[white] row-span-full col-span-full row-start-2 rounded-lg md:shadow-lg shadow-md",children:n})]})]})}function E({n:c,lineProperty:l}){const n=O({from:{[l]:"0%"},to:{[l]:"100%"},delay:l==="height"?c*100:c*30}),o=l==="height"?"border-r-2 w-full left-[1px]":"border-b-2 h-full top-[1px]";return e.jsx(y.div,{className:`${l==="height"?"w-full py-2":"h-full px-2"} box-border`,style:n,children:e.jsx("div",{className:`${o} border-[hsl(0,0%,77%)] h-full w-full relative`})})}function ee({blocksToShow:c,login:l}){const n=L(c,{from:{y:-20,scale:0},enter:{y:0,scale:1},leave:{y:-20,scale:0},trail:50}),{chosenClasses:o,setChosenClasses:a}=i.useContext(v);return n((d,r)=>{const s=Object.entries(r.time).flat();return e.jsxs(y.div,{className:`md:text-[14px] md:leading-[14px] text-[8px] leading-[10px] z-10 p-1 border border-[black] outline outline-1 outline-[black] text-[black] ${l?"":"cursor-pointer"} rounded-lg overflow-hidden`,style:{gridColumnStart:s[0],gridRowStart:s[1][0],gridRowEnd:s[1][1],backgroundColor:r.color,...d},onClick:()=>{l||a(o.filter(t=>t.code!==r.code))},children:[e.jsx("p",{className:"line-clamp-2 font-semibold",children:r.title}),e.jsx("p",{className:"line-clamp-1 font-light mt-1",children:r.code}),e.jsx("p",{className:"font-light",children:r.section}),e.jsx("p",{className:"line-clamp-2 mt-1",children:r.teacher})]},r.code+r.section+s[0])})}export{v as C,ae as S,K as V,P as c,J as h};
